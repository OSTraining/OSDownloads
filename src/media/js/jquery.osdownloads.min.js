!function(e){e(function(){e(".osdownloads-modal").appendTo(e("body"))}),e.fn.osdownloads=function(a){var r={animation:"fade",elementsPrefix:"osdownloads",popupElementId:"osdownloadsRequirementsPopup"},a=e.extend({},r,a);return this.length?this.each(function(){var r=e(this),n=e("#"+a.elementsPrefix+"DownloadContinue"),o=e("#"+a.popupElementId),t=e("#"+a.elementsPrefix+"ErrorAgreeTerms"),i=e("#"+a.elementsPrefix+"ErrorInvalidEmail"),l=e("#"+a.elementsPrefix+"RequireAgree"),s=e("#"+a.elementsPrefix+"RequireEmail"),d=e("#"+a.elementsPrefix+"EmailGroup"),m=e("#"+a.elementsPrefix+"AgreeGroup"),c=e("#"+a.elementsPrefix+"RequiredEmailMessage"),f=(e("#"+a.elementsPrefix+"TermsAnchor"),r.data("direct-page"),r.data("require-email")),u=1==r.data("require-agree"),h=function(){var e=/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,a=!1;if(u&&(l.is(":checked")?t.hide():(a=!0,t.show())),1==f){var r=s.val().trim();""!==r&&e.test(r)?i.hide():(a=!0,i.show())}else if(2==f){var r=s.val().trim();""==r||e.test(r)?i.hide():(a=!0,i.show())}return a?!1:!0},p=function(r){e(r).reveal({animation:a.animation,animationspeed:200,closeonbackgroundclick:!0,dismissmodalclass:"close-reveal-modal"})},v=function(){var n=r.attr("href");s.length>0&&(n+="&email="+s.val().trim()),l.length>0&&(n+="&agree="+(l.attr("checked")?1:0)),$container=e("<div>").attr("id",a.elementsPrefix+"PopupIframe").addClass("reveal-modal").addClass("osdownloads-modal"),$iframe=e("<iframe>").attr("src",n),$iframe.iframeAutoHeight({heightOffset:10}),$close=e('<a class="close-reveal-modal">&#215;</a>'),$iframe.appendTo($container),$close.appendTo($container),$container.appendTo(e("body")),$container.on("reveal:close",function(){setTimeout(function(){$container.remove()},500)}),o.trigger("reveal:close"),setTimeout(function(){p("#"+a.elementsPrefix+"PopupIframe")},500)};r.on("click",function(t){t.preventDefault(),f||u?(0!=f?(1==f?c.show():c.hide(),d.show()):d.hide(),u?(m.find(".agreement-article").attr("href",r.data("agreement-article")),m.show()):m.hide(),n.attr("href",r.attr("href")),p("#"+a.popupElementId),o.on("reveal:close",function(){s.val(""),l.attr("checked",!1),e(".osdownloads-modal .error").hide()}),n.off(),n.on("click",function(e){e.preventDefault(),h()&&v()})):v()})}):void 0}}(jQuery);